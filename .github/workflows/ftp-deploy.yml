name: üöÄ FTP Deploy

on:
  push:
    branches: [ main ]
  workflow_dispatch:  # –ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å –¥–µ–ø–ª–æ–π –≤—Ä—É—á–Ω—É—é

jobs:
  deploy:
    name: üìÇ Deploy Website
    runs-on: ubuntu-latest
    
    steps:
      - name: üõí Checkout code
        uses: actions/checkout@v3
      
      # === FTP –º–µ—Ç–æ–¥ (–µ—Å–ª–∏ –≤–∞—à —Ö–æ—Å—Ç–∏–Ω–≥ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ FTP) ===
      - name: üì§ Deploy using FTP
        uses: SamKirkland/FTP-Deploy-Action@v4.3.4
        with:
          server: ${{ secrets.FTP_SERVER }}
          username: ${{ secrets.FTP_USERNAME }}
          password: ${{ secrets.FTP_PASSWORD }}
          protocol: ftp
          port: 21
          timeout: 120000  # –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π —Ç–∞–π–º–∞—É—Ç –¥–æ 2 –º–∏–Ω—É—Ç
          local-dir: ./    # –õ–æ–∫–∞–ª—å–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è –¥–µ–ø–ª–æ—è
          server-dir: /    # –£–¥–∞–ª–µ–Ω–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
          dangerous-clean-slate: false  # –ù–µ —É–¥–∞–ª—è—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
          exclude: |
            **/.git*
            **/.git*/**
            **/node_modules/**
            **/.github/**
            **/vendor/**
            composer.json
            composer.lock
            README.md
            .gitignore
            deployment-report.md
            **/testcode/**
            includes/config/db_config.php
            test-ftp-connection.php
            test-sftp-connection.php
          log-level: verbose  # –ü–æ–¥—Ä–æ–±–Ω—ã–π –ª–æ–≥ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

      # === –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞ –æ –¥–µ–ø–ª–æ–µ (–ø–æ –∂–µ–ª–∞–Ω–∏—é) ===
      - name: üìù Create Deployment Summary
        if: success()
        run: |
          echo "## üöÄ Deployment Successful!" >> $GITHUB_STEP_SUMMARY
          echo "**Branch:** $(git branch --show-current)" >> $GITHUB_STEP_SUMMARY
          echo "**Deployed:** $(date)" >> $GITHUB_STEP_SUMMARY
          echo "**Commit:** $(git rev-parse --short HEAD)" >> $GITHUB_STEP_SUMMARY

# –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–µ–ø–ª–æ—è (–∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã)
# –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –Ω—É–∂–Ω—ã–π –º–µ—Ç–æ–¥ –∏ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –æ—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥ –≤—ã—à–µ

# === SFTP –º–µ—Ç–æ–¥ (–µ—Å–ª–∏ –≤–∞—à —Ö–æ—Å—Ç–∏–Ω–≥ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç SFTP) ===
# name: üöÄ SFTP Deploy
# 
# on:
#   push:
#     branches: [ main ]
#   workflow_dispatch:
# 
# jobs:
#   deploy:
#     name: üìÇ Deploy Website via SFTP
#     runs-on: ubuntu-latest
#     
#     steps:
#       - name: üõí Checkout code
#         uses: actions/checkout@v3
#       
#       - name: üì§ Deploy using SFTP
#         uses: wlixcc/SFTP-Deploy-Action@v1.2.4
#         with:
#           username: ${{ secrets.FTP_USERNAME }}
#           server: ${{ secrets.FTP_SERVER }}
#           port: 22
#           password: ${{ secrets.FTP_PASSWORD }}  # –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ø–∞—Ä–æ–ª—å
#           # ssh_private_key: ${{ secrets.SSH_PRIVATE_KEY }}  # –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ SSH-–∫–ª—é—á (–±–æ–ª–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç)
#           local_path: ./
#           remote_path: /
#           delete_remote_files: false
#           exclude: ".git*,.github*,node_modules,vendor,composer.json,composer.lock,README.md,.gitignore,deployment-report.md,testcode,includes/config/db_config.php,test-ftp-connection.php,test-sftp-connection.php"
# 
#       - name: üìù Create Deployment Summary
#         if: success()
#         run: |
#           echo "## üöÄ SFTP Deployment Successful!" >> $GITHUB_STEP_SUMMARY
#           echo "**Branch:** $(git branch --show-current)" >> $GITHUB_STEP_SUMMARY
#           echo "**Deployed:** $(date)" >> $GITHUB_STEP_SUMMARY
#           echo "**Commit:** $(git rev-parse --short HEAD)" >> $GITHUB_STEP_SUMMARY

# === –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ FTP-–¥–µ–ø–ª–æ—è (–µ—Å–ª–∏ –æ—Å–Ω–æ–≤–Ω–æ–π –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç) ===
# name: üöÄ Alternative FTP Deploy
# 
# on:
#   push:
#     branches: [ main ]
#   workflow_dispatch:
# 
# jobs:
#   deploy:
#     name: üìÇ Deploy Website (Alternative)
#     runs-on: ubuntu-latest
#     
#     steps:
#       - name: üõí Checkout code
#         uses: actions/checkout@v3
#       
#       - name: üì§ Alternative FTP Deploy
#         uses: SamKirkland/web-deploy@v1
#         with:
#           target-server: ${{ secrets.FTP_SERVER }}
#           remote-user: ${{ secrets.FTP_USERNAME }}
#           remote-password: ${{ secrets.FTP_PASSWORD }}
#           protocol: ftp
#           port: 21
#           local-dir: ./
#           remote-dir: /
#           exclude: "**/.git*,**/.git*/**,**/node_modules/**,**/.github/**,**/vendor/**,composer.json,composer.lock,README.md,.gitignore,deployment-report.md,**/testcode/**,includes/config/db_config.php" 