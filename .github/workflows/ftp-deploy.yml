name: FTP Deploy

on:
  push:
    branches:
      - main

jobs:
  deploy:
    runs-on: ubuntu-latest
    timeout-minutes: 10  # –î–æ–±–∞–≤–ª—è–µ–º –æ–±—â–∏–π —Ç–∞–π–º–∞—É—Ç –¥–ª—è –∑–∞–¥–∞—á–∏

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: üìÇ Deploy files via FTP
        uses: SamKirkland/FTP-Deploy-Action@v4.3.4
        with:
          server: ${{ secrets.FTP_SERVER }}
          username: ${{ secrets.FTP_USERNAME }}
          password: ${{ secrets.FTP_PASSWORD }}
          protocol: ftps  # –ú–µ–Ω—è–µ–º –Ω–∞ FTPS –¥–ª—è –±–æ–ª—å—à–µ–π –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
          port: 21
          local-dir: ./
          server-dir: /www/x64shop.ru/
          dangerous-clean-slate: false
          timeout: 120000  # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Ç–∞–π–º–∞—É—Ç –¥–æ 2 –º–∏–Ω—É—Ç
          passive: true    # –î–æ–±–∞–≤–ª—è–µ–º –ø–∞—Å—Å–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º
          security: loose  # –î–æ–±–∞–≤–ª—è–µ–º –º–µ–Ω–µ–µ —Å—Ç—Ä–æ–≥–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
          exclude: |
            **/.git*
            **/.git*/**
            **/node_modules/**
            **/.github/**
            **/vendor/**
            composer.json
            composer.lock
            README.md
            .gitignore
            deployment-report.md
            **/testcode/**
            includes/config/db_config.php
            test-ftp-connection.php
            test-sftp-connection.php
            **/*.log
            **/*.tmp
            **/.DS_Store
          log-level: verbose  # –ü–æ–¥—Ä–æ–±–Ω—ã–π –ª–æ–≥ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
